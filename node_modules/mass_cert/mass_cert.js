const { createCanvas, loadImage } = require('canvas');
const fs = require('fs');
const readline = require('readline');
const canvas = createCanvas(1000, 750)
const ctx = canvas.getContext('2d')

//const names =[]
function certmaker(listfile,certimg,saveloc){

 
  const file = readline.createInterface({
    input: fs.createReadStream(listfile),//'./list.json'
    output: process.stdout,
    terminal: false
  });
  // Write "Awesome!"
  //ctx.font = '30px Impact'
  //ctx.rotate(0.1)
  //ctx.fillText('Krishna Gupta', 50, 100)
  
  file.on('line',(line) => {
    line = line.trim();
    console.log(line);
  loadImage(certimg).then( (image) => { //'./training_cert.png'
    ctx.drawImage(image, 0, 0, 1000, 750)
  
    // Write "Awesome!"
    ctx.font = 'bold italic 50px Sans'
        //ctx.rotate(0.1)
    ctx.textAlign = "center"
    ctx.fillStyle = '#364d65'
    ctx.fillText(line, 500, 350)
    ctx.font = 'bold 20px Sans'
    ctx.fillText("Event on AI Basics", 500, 480)
    ctx.font = '17px Sans'
    ctx.fillText("on", 500,510)
    ctx.font = 'bold 20px Sans'
    ctx.fillText("October 1 2022 10:20", 500, 540)
  
    const buffer = canvas.toBuffer('image/png')
   fs.writeFileSync(saveloc+line+'.png', buffer) //'./tcertificates/'
  
          //console.log('<img src="' + canvas.toDataURL() + '" />')
        })
  });
  
  // adding name
  
}
module.exports = { certmaker };